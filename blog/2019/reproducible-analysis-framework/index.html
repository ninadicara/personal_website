<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Nina  Di Cara


  | Building a reproducible analysis framework

</title>
<meta name="description" content="Website and projects
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.xyz/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŒ»</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="/blog/2019/reproducible-analysis-framework/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav sticky-bottom-footer">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
       <span class="font-weight-bold">Nina</span>   Di Cara
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/code/">
                code
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                projects
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      

<div class="post">

  <header class="post-header">
    <h1 class="post-title">Building a reproducible analysis framework</h1>
    <p class="post-meta">June 3, 2019</p>
  </header>

  <article class="post-content">
    <p>Since starting in research Iâ€™ve learnt some home truths about reproducibility in science. 
Thanks some fantastic researchers (listed at the end) Iâ€™ve also been taught some amazing lessons about 
reproducibility, and how to do it. So much so that I canâ€™t see why you would work any other way, which is itself
testament to the power of educating a new generation of scientists with lessons learned.</p>

<p>My main focus so far has been creating a repoducible analysis framework for my quantitative work. How can I ensure that, 
given the same data, someone else (or, future me) could either reproduce or replicate what I have done?</p>

<p>Iâ€™m following some pretty basic principles that I have picked up since starting that apply from the very beginning of a project
to the end. Many of them are related to good data management, recording and programming practices - itâ€™s just a matter of remembering
to do them all together, all the way through!</p>

<h2 id="1-record-the-variables-you-decide-to-use-why-you-chose-them-and-how-you-refined-them">1. Record the variables you decide to use, why you chose them, and how you refined them.</h2>
<p>In my case I had several spreadsheets which I selected from a cohort study database, and slowly refined so that I know exactly 
which variables Iâ€™ve pruned from my dataset and why. Iâ€™ve kept the source ID for each variable
as well as my own description of what it is. This is essentially a data dictionary.</p>

<p>If you are planning to do any work with data then keeping a well defined and thorough data dictionary is a must. Personally, working
with large numbers of variables it has been so useful for my own work, but I also know I could share it with anyone. 
DO NOT use colours in your data dictionary - if a colour represents something then turn it into a variable. Anything that wonâ€™t export to 
csv does not belong there!</p>

<h2 id="2-folder-structure">2. Folder Structure</h2>
<p>I went to a great conference in February called DataTech, run by The Data Lab. One of the sessions was about reproducible code, and gave some 
great advice about working with data. 
Always have a folder where you store your original data exactly as you received it. Lock this down, never edit it. 
Then copy this file for use in your analysis. You never want to be in a situation where you cannot remember what the original layout of your
file looked like because youâ€™ve overwritten it so many times. 
My file set up tends to look like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Project Folder  
â”œâ”€ raw-data-DO-NOT-TOUCH  
â”œâ”€ processed-data  
â”œâ”€ analysis  
â”œâ”€ figures  
â””â”€ manuscript
</code></pre></div></div>

<p>I might tweak in the future but at least for now everything is consistent and I can find all my scriptsâ€¦</p>

<h2 id="3-scripting">3. Scripting</h2>
<p>This one kind of dependings on how far you want to go, but we can start small with one simple rule.</p>

<p><strong>Avoid pre-processing in Excel.</strong></p>

<p>Imagine trying to reproduce someoneâ€™s work - you have the original data file, but the file used for the analysis in their code is completely different. 
You have zero clue how to turn the original data into the analysis-ready data because they did it all using Excel.</p>

<p>To avoid this you have two options. For those who are really code-phobic, you could theoretically use Excelâ€™s handy macro feature to record the work you
do on the dataset in Excel. This should produce an Excel Macro script (written in Excelâ€™s native language VBA) which would show exactly what you did and
hopefully allow someone else to reproduce it by running the script.</p>

<p>Similarly in SPSS you could use the internal scripting language to record your actions so that anyone else could see exactly what steps you took to 
create your work.</p>

<p>Alternatively, you could commit to learning R or Python and write a script to do this for you. A step-up from this 
might be producing functions, or even a package, with your whole analysis framework in it.</p>

<p>Aside from pre-processing, itâ€™s good practice to write scripts for your data analysis. This is harder in GUI based systems such as SPSS, which is why
I would always recommend biting the bullet and just getting stuck in with R. 
My R files used to be a mess of attempted analyses and unordered operations. Even if you had the right dataset, you wouldnâ€™t have 
a clue how to replicate my results. Aim to write your analysis as a script that calls all the relevant dependencies and, if executed by a user, could
just run through and output all the results that you have used. Which leads me to my next pointâ€¦</p>

<h2 id="4-commenting">4. Commenting</h2>
<p>COMMENT YOUR CODE. 
Apparently, the golden rule is that there should be as much commenting as there is code. 
I find that overkill, but at the very least explain what every method or function does. Why have you used that number as the input there?
What does that obscure argument do?
If someone else went through your script would they know where to edit it to make it fit their data? Would they ask you a million questions 
about how bits of it work?</p>

<h2 id="5-version-control">5. Version Control</h2>
<p>This is one Iâ€™m working on a lot. At the beginning of a project I have a lot of draft scripts. To begin with they donâ€™t look pretty - 
theyâ€™re messy, full of attempts to do things that donâ€™t work and take a lot of development to get to a point where theyâ€™re ready to share.</p>

<p>What should happen throughout that process is version control. This is most commonly done using a version control system called git. Git
can be run from the commmand line and basically makes sure you are saving versions of your work as you go through the project. Then, at the end
you have a record of every iteration you went through to get to the final product.</p>

<p>Iâ€™m hoping to do another post soon about using git as part of my analysis system on Windows 10 (which seems to be slightly trickier than unix based
systems e.g linux and mac).</p>

<p>I hope this has given you some ideas if you are just thinking about how to develop a reproducible analysis framework for working with data.</p>

<p>P.S. Some people and sites Iâ€™ve found helpful! 
<a href="https://twitter.com/OrbenAmy">@amyorben</a>
<a href="https://twitter.com/kirstie_j">@kirstiewhittaker</a>
<a href="https://paperswithcode.com/">Papers with Code</a></p>


  </article>

  

</div>

    </div>

    <!-- Footer -->

    
<footer class="sticky-bottom mt-5">
  <div class="container">
    &copy; Copyright 2021 Nina  Di Cara.
    
    
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
