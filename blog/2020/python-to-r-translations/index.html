<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Nina  Di Cara


  | Useful Python to R translations

</title>
<meta name="description" content="Website and projects
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.xyz/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŒ»</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="/blog/2020/python-to-r-translations/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav sticky-bottom-footer">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
       <span class="font-weight-bold">Nina</span>   Di Cara
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/code/">
                code
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                projects
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      

<div class="post">

  <header class="post-header">
    <h1 class="post-title">Useful Python to R translations</h1>
    <p class="post-meta">July 28, 2020</p>
  </header>

  <article class="post-content">
    <p>After spending 3 months on a Python project (see the <a href="https://ninadicara.co.uk/projects/covid-community-map/">COVID-19 community map here!</a>) Iâ€™ve gone back to an R project that I started in 2019. After getting used to using Python there have been a few functions that Iâ€™ve really missed in R, so Iâ€™ve collected a few substitutes that Iâ€™ve found.</p>

<h3 id="recreating-in_place">Recreating <code class="language-plaintext highlighter-rouge">in_place</code></h3>

<p>Usually when using Pandas itâ€™s really easy to apply a change to a data frame without allocating it to a new obejct by using the argument <code class="language-plaintext highlighter-rouge">in_place</code> as part of the function. Typically in R Iâ€™m using <code class="language-plaintext highlighter-rouge">dplyr</code>, so I would usually do something likeâ€¦</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>df &lt;- df %&gt;% foo()
</code></pre></div></div>

<p>But Iâ€™ve recently discovered that there are various versions of the well know pipe operator <code class="language-plaintext highlighter-rouge">%&gt;%</code> as part of the <a href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html"><code class="language-plaintext highlighter-rouge">magrittr</code> package</a>. The <em>compound assignment pipe operator</em> looks like <code class="language-plaintext highlighter-rouge">%&lt;&gt;%</code> and would work like so:</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">magrittr</span><span class="p">)</span><span class="w">
</span><span class="n">df</span><span class="w"> </span><span class="o">%&lt;&gt;%</span><span class="w"> </span><span class="n">foo</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p>It both allows you to pipe from the first object, and also assigns everything to the RHS back to the first object. Small moments of programming happiness.</p>

<h3 id="managing-conflicts">Managing conflicts</h3>

<p>Returning to R reminded me how often there are package conflicts with R packages. Often the conflicts are hidden behind warnings or errors that donâ€™t make sense until you eventually debug the true reason. There are two ways to get around this.</p>

<p>The first way is a fairly common one, to specify the package you mean when youâ€™re using the function from it by stating the package name, followed by two colons. This would look like:</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Original </span><span class="w">
</span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">recode</span><span class="p">(</span><span class="n">...</span><span class="p">)</span><span class="w">

</span><span class="c1"># Alternative </span><span class="w">
</span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">dplyr</span><span class="o">::</span><span class="n">recode</span><span class="p">(</span><span class="n">...</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>My new favourite option though, to reduce how often this is necessary, is a package called <code class="language-plaintext highlighter-rouge">conflicted</code>, <a href="https://conflicted.r-lib.org/">written by Hadley Wickham</a>. If installed and loaded in your session, it will point out to you in the console when you are using a function that belongs to two packages.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Loading the library will mean you are notified of any conflicts, </span><span class="w">
</span><span class="c1"># and will be asked to state a preference using :: or the below...</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">conflicted</span><span class="p">)</span><span class="w">

</span><span class="c1"># State a preference for using the recode function from dplyr</span><span class="w">
</span><span class="n">conflict_prefer</span><span class="p">(</span><span class="s2">"recode"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dplyr"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Look for conflicts in your currently loaded packages</span><span class="w">
</span><span class="n">conflict_scout</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p>This package has saved me so much time already.</p>

<h3 id="creating-absolute-file-paths">Creating absolute file paths</h3>

<p>The last function that Iâ€™ve found really useful in Python is from the <code class="language-plaintext highlighter-rouge">os</code> package.</p>

<p>In any given file you can get the absolute file path of a current file using:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span>
</code></pre></div></div>

<p>You can also use <code class="language-plaintext highlighter-rouge">os</code> to create OS agnostic file paths:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="s">"home"</span><span class="p">,</span> <span class="s">"project_folder"</span><span class="p">,</span> <span class="s">"file_I_want.py"</span><span class="p">)</span>
</code></pre></div></div>

<p>This will mean that it doesnâ€™t matter if you are on Windows or Mac (forward vs back slashes in file paths) - the script will still run as intended.</p>

<p>There are a few reasons this is helpful, but the main one is that it allows your scripts to be run reproducibly by different people, no matter where they download your files to, or what system they are running. Much better than <code class="language-plaintext highlighter-rouge">setwd()</code> !</p>

<p>Introducing <a href="https://here.r-lib.org/"><code class="language-plaintext highlighter-rouge">here</code></a> !  If you <a href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects">make your directory of R files an R project</a> then you can treat the project root as your base directory. You can then write files paths from the root directory, which will be reproducible within the project. I use it all the time for reading my files.</p>

<p>For example if you had the following project structure:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~  
â”œâ”€â”€â”€myProject.Rprj  
â”œâ”€â”€â”€data  
â”‚   â””â”€â”€â”€my_data.RDS  
â”œâ”€â”€â”€scripts  
â”‚   â””â”€â”€â”€this_script.R  
â”œâ”€â”€â”€figures  
â””â”€â”€â”€tables  
</code></pre></div></div>

<p>from <code class="language-plaintext highlighter-rouge">this_script.R</code> you could do:</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">here</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">

</span><span class="c1"># Read data</span><span class="w">
</span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">readRDS</span><span class="p">(</span><span class="n">here</span><span class="p">(</span><span class="s2">"data"</span><span class="p">,</span><span class="w"> </span><span class="s2">"my_data.RDS"</span><span class="p">))</span><span class="w">

</span><span class="c1"># Write plot to correct folder</span><span class="w">
</span><span class="n">figure1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w">
</span><span class="n">ggsave</span><span class="p">(</span><span class="n">here</span><span class="p">(</span><span class="s2">"output"</span><span class="p">,</span><span class="w"> </span><span class="s2">"figure1.png"</span><span class="p">))</span><span class="w">

</span><span class="c1"># Write dataframe to csv</span><span class="w">
</span><span class="n">write.csv</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">here</span><span class="p">(</span><span class="s2">"output"</span><span class="p">,</span><span class="w"> </span><span class="s2">"table1.csv"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p>Hopefully someone else will find this useful :)</p>

  </article>

  

</div>

    </div>

    <!-- Footer -->

    
<footer class="sticky-bottom mt-5">
  <div class="container">
    &copy; Copyright 2021 Nina  Di Cara.
    
    
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
